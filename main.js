(()=>{"use strict";var e={187:e=>{var t,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,o){function i(n){e.removeListener(t,s),o(n)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,s,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,{once:!0})}(e,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var r=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function a(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,n,o){var i,s,r,c;if(u(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),r=s[t]),void 0===r)r=s[t]=n,++e._eventsCount;else if("function"==typeof r?r=s[t]=o?[n,r]:[r,n]:o?r.unshift(n):r.push(n),(i=a(e))>0&&r.length>i&&!r.warned){r.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=r.length,c=l,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(o);return i.listener=n,o.wrapFn=i,i}function h(e,t,n){var o=e._events;if(void 0===o)return[];var i=o[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function b(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}function m(e,t,n,o){if("function"==typeof e.on)o.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(s){o.once&&e.removeEventListener(t,i),n(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");r=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return a(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var r;if(t.length>0&&(r=t[0]),r instanceof Error)throw r;var u=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw u.context=r,u}var a=s[e];if(void 0===a)return!1;if("function"==typeof a)o(a,this,t);else{var c=a.length,l=f(a,c);for(n=0;n<c;++n)o(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,o,i,s,r;if(u(t),void 0===(o=this._events))return this;if(void 0===(n=o[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){r=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(o[e]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",e,r||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(o=0;o<s.length;++o)"removeListener"!==(i=s[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):b.call(e,t)},s.prototype.listenerCount=b,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}(()=>{const e=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],t={A:"./audio/keyboard/A1.[mp3|ogg]","A#":"./audio/keyboard/As1.[mp3|ogg]",Bb:"./audio/keyboard/As1.[mp3|ogg]",B:"./audio/keyboard/B1.[mp3|ogg]",Cb:"./audio/keyboard/B1.[mp3|ogg]",C:"./audio/keyboard/C2.[mp3|ogg]","C#":"./audio/keyboard/Cs2.[mp3|ogg]",Db:"./audio/keyboard/Cs2.[mp3|ogg]",D:"./audio/keyboard/D2.[mp3|ogg]","D#":"./audio/keyboard/Ds2.[mp3|ogg]",Eb:"./audio/keyboard/Ds2.[mp3|ogg]",E:"./audio/keyboard/E2.[mp3|ogg]",Fb:"./audio/keyboard/E2.[mp3|ogg]",F:"./audio/keyboard/F2.[mp3|ogg]","F#":"./audio/keyboard/Fs2.[mp3|ogg]",Gb:"./audio/keyboard/Fs2.[mp3|ogg]",G:"./audio/keyboard/G2.[mp3|ogg]","G#":"./audio/keyboard/Gs1.[mp3|ogg]",Ab:"./audio/keyboard/Gs1.[mp3|ogg]"},o={hh:"./audio/percussion/hh.[mp3|ogg]",hho:"./audio/percussion/hho.[mp3|ogg]",kick:"./audio/percussion/kick.[mp3|ogg]",snare:"./audio/percussion/snare.[mp3|ogg]"},i={C:["C","D","E","F","G","A","B","C"],"C#/Db":["Db","Eb","F","Gb","Ab","Bb","C","Db"],D:["D","E","F#","G","A","B","C#","D"],"D#/Eb":["Eb","F","G","Ab","Bb","C","D","Eb"],E:["E","F#","G#","A","B","C#","D#","E"],F:["F","G","A","Bb","C","D","E","F"],"F#/Gb":["Gb","Ab","Bb","Cb","Db","Eb","F","Gb"],G:["G","A","B","C","D","E","F#","G"],"G#/Ab":["Ab","Bb","C","Db","Eb","F","G","Ab"],A:["A","B","C#","D","E","F#","G#","A"],"A#/Bb":["Bb","C","D","Eb","F","G","A","Bb"],B:["B","C#","D#","E","F#","G#","A#","B"]},s={A:["A","B","C","D","E","F","G","A"],"A#/Bb":["Bb","C","Db","Eb","F","Gb","Ab","Bb"],B:["B","C#","D","E","F#","G","A","B"],C:["C","D","Eb","F","G","Ab","Bb","C"],"C#/Db":["Db","Eb","Fb","Gb","Ab","A","B","Db"],D:["D","E","F","G","A","Bb","C","D"],"D#/Eb":["Eb","F","Gb","Ab","Bb","Cb","Db","Eb"],E:["E","F#","G","A","B","C","D","E"],F:["F","G","Ab","Bb","C","Db","Eb","F"],"F#/Gb":["F#","G#","A","B","C#","D","E","F#"],G:["G","A","Bb","C","D","Eb","F","G"],"G#/Ab":["Ab","Bb","Cb","Db","Eb","Fb","Gb","Ab"]},r=new Nexus.Button("#button",{mode:"toggle",state:!0});r.colorize("accent","#fdcc52"),r.colorize("fill","#fdcc52"),r.colorize("mediumLight","#212529");const u=new Nexus.Slider("#slider",{mode:"relative",min:80,max:200,step:0,value:120});u.colorize("accent","#7b4397");const a=new Nexus.Number("#bpm",{value:6,min:0,max:2e4,step:1,size:[80,30]}),c=new Nexus.Select("#notelist",{size:[80,30],options:Object.keys(i)}),l=new Nexus.Select("#scalelist",{size:[120,30],options:["Major Scale","Minor Scale"]});a.link(u);var p=n(187);class h extends p.EventEmitter{constructor(e,t){super(),this.music=null,this.beats=e,this.interval=t}init(){this.music=new Tone.Sequence(this.loop,this.beats,this.interval),Tone.Transport.start()}setting(e,t){this.beats=e,this.interval=t}start(){Tone.context.resume().then((()=>this.music.start()))}stop(){Tone.context.resume().then((()=>{this.emit("stop-scroll"),this.music.stop()}))}loop=(e,t)=>{this.emit("scroll",e,t)};set bpm(e){Tone.Transport.bpm.value=e}}const b=h,f=new b(e,"16n"),m=new class{constructor(){this.percussion=["hh","hho","kick","snare"],this.note="C",this.scale=i[this.note],this.scaleType="Major Scale"}musicScaleChange(){"Major Scale"===this.scaleType?this.scale=i[this.note]:"Minor Scale"===this.scaleType&&(this.scale=s[this.note])}set musicNote(e){this.note=e,this.musicScaleChange()}set musicScale(e){this.scaleType=e,this.musicScaleChange()}getNotes(e){return e.map(((e,t)=>e?this.scale[t]:null)).filter((e=>e))}getPercussions(e){return e.map(((e,t)=>e?this.percussion[t]:null)).filter((e=>e))}},v=new class{constructor(){this.time=0,this.KBNotes=[],this.PNotes=[],this.keyboard=new Tone.Players(t,{volume:-10,fadeOut:"64n"}).toMaster(),this.percussion=new Tone.Players(o,{volume:-10,fadeOut:"4n"}).toMaster()}play(){this.KBNotes.map((e=>this.keyboard.get(e).start(this.time,0,"4n"))),this.PNotes.map((e=>this.percussion.get(e).start(this.time,0,"16n")))}set keyBoardNotes(e){this.KBNotes=e}set percussionNotes(e){this.PNotes=e}set setTime(e){this.time=e}},d=new class{constructor(){this.postition=0,this.keyboard=new Nexus.Sequencer("#sequencer",{mode:"toggle",rows:7,columns:e.length}),this.keyboard.colorize("accent","#fdcc52"),this.keyboard.colorize("fill","#212529"),this.percussion=new Nexus.Sequencer("#percussion",{mode:"toggle",rows:4,columns:e.length}),this.percussion.colorize("accent","#fdcc52"),this.percussion.colorize("fill","#212529")}step(){this.keyboard.next(),this.percussion.next()}reset(){this.keyboard.stepper.value=-1,this.percussion.stepper.value=-1,this.step()}set setPosition(e){this.postition=e}get kbActivations(){return this.keyboard.matrix.column(this.postition)}get pActivations(){return this.percussion.matrix.column(this.postition)}};f.on("scroll",((e,t)=>{d.setPosition=t,d.step(),v.setTime=e,v.keyBoardNotes=m.getNotes(d.kbActivations),v.percussionNotes=m.getPercussions(d.pActivations),v.play()})),f.on("stop-scroll",(()=>{d.reset()})),f.init(),c.on("change",(function(e){m.musicNote=e.value})),u.on("change",(function(e){f.bpm=e})),r.on("change",(function(e){e?f.stop():f.start()})),l.on("change",(function(e){m.musicScale=e.value}))})()})();